doctype html
html(lang="en")
    head
        meta(charset="UTF-8")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        link(rel="stylesheet", href="http://localhost:3000/stylesheets/main.css")
        title SNS
        script(src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js")
    body
        .head-bar
            h1 SNS
            .search-box
                input(type="text")
                button 찾기
        div(class ="main-container", id="main-container")
            .editor-container
                textarea#editor(cols="30", rows="10")
                div
                    button#write-button 글쓰기
            button(class="get-article-button",id="get-latest-articles") 새로운 글 불러오기
            #article-container
                div
                    each article in articleList
                        .articleBox
                            .article-flex-container
                                .head-flex-container
                                    .no #{article.No}
                                    .date #{article.date}
                                    .writer #{article.writer}
                                .article #{article.article}
                button(class="get-article-button",id="get-old-articles") 예전 글 불러오기
                        
                               
    script(src="http://localhost:3000/javascripts/main.js")
    script.
        (
            function (getOldButton,getLatestButton) {
                let oldestNo = #{_oldestNo};
                let latestNo = #{_latestNo};

                getLatestButton.addEventListener('click',()=>{
                    axios.get(`http://localhost:3000/article?from=null&to=${latestNo}&limit=null`).then((res) => {
                        displayArticle(true, res.data);
                        latestNo = res.data.length ? res.data[0].No : latestNo;
                    })
                })


                getOldButton.addEventListener('click',getArticle = ()=>{
                    axios.get(`http://localhost:3000/article?from=${oldestNo}&to=null&limit=${oldestNo > 10 ? 10 : latestNo +1}`).then((res) => {
                        if (res.data.length < 10) {
                            getOldButton.removeEventListener('click',getArticle)
                        }
                        displayArticle(false, res.data);
                        oldestNo = res.data.length ? res.data[res.data.length - 1].No : 0;
                    })
                })
            }
        )(document.getElementById('get-old-articles'),document.getElementById('get-latest-articles'));